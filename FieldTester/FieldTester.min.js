(function(){"use strict";var b=window.location.href,h=document;function g(i,l,j,d){try{d=new (window.XMLHttpRequest||ActiveXObject)("MSXML2.XMLHTTP.3.0");d.open(j?"POST":"GET",i,1);d.setRequestHeader("X-Requested-With","XMLHttpRequest");d.setRequestHeader("Content-type","application/x-www-form-urlencoded");d.onreadystatechange=function(){d.readyState>3&&l&&l(d.responseText,d)};d.send(j)}catch(k){window.console&&console.log(k)}}function f(d){var i=Date.now()-d;return""+(i>1000?i/1000:i+"m")+"s"}function c(j,d){if(!j.length){return}var k=j.shift(),i=d.shift(),l="/query?where=not+field+is+null&returnGeometry=false&returnCountOnly=true&f=json".replace("field",k.name),m=Date.now();g(b+l,function(n){n=JSON.parse(n);var o=h.createElement("ul");o.innerHTML="<li>"+["<b>Features with values: </b>"+n.count+(!n.count?"<b style=\"color:#f00;\"> !!!</b>":""),"<b>Response Time: </b>"+f(m)].join("</li><li>")+"</li>";i.appendChild(o);if(j.length){c(j,d)}})}function a(){var j=h.getElementsByTagName("ul"),k=[].map.call(j,function(l){var i=l;while(i.previousSibling){i=i.previousSibling;if(i.tagName==="B"){break}}return i.innerHTML}),d;for(d=j.length-1;d>-1;d--){if(/^Fields\:/.test(k[d])){return[].map.call(j[d].children,function(i){return i})}}return null}function e(d){d=JSON.parse(d);if(d.fields){c(d.fields,a())}}if(/\d+\/?$/.test(b)){g(b+"?f=json",e)}else{if(!/(map|feature)server\/?$/i.test(b)){alert("Pick a map/feature service and layer")}else{alert("Pick a valid layer")}}}());
