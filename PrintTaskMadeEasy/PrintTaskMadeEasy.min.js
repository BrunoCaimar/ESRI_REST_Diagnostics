(function(){var a=window.location.href.split("?")[0],i=document,c=/(execute|submitjob)\/?$/ig;function g(j,m,k,d){try{d=new (window.XMLHttpRequest||ActiveXObject)("MSXML2.XMLHTTP.3.0");d.open(k?"POST":"GET",j,1);d.setRequestHeader("X-Requested-With","XMLHttpRequest");d.setRequestHeader("Content-type","application/x-www-form-urlencoded");d.onreadystatechange=function(){d.readyState>3&&m&&m(JSON.parse(d.responseText),d)};d.send(k)}catch(l){window.console&&console.log(l)}}function e(d,k,m){var l=i.createElement(d),j;for(j in k){l.setAttribute(j,k[j])}if(m){l.innerHTML=m}return l}function h(j,d){j.forEach(function(m){if(!m.choiceList){return}console.log("Parameter...",m);var k=e("select",{name:m.name});m.choiceList.forEach(function(n){var o=e("option",{value:n},n);k.appendChild(o)});k.value=m.defaultValue;var l=d.filter(function(n){console.log(n.name);return n.name===m.name})[0];l.parentNode.replaceChild(k,l)})}function b(d){return[].map.call(d,function(j){return j})}function f(j){var l,m=[],d;if(!j.parameters){alert("Could not find GP parameters for this task.");return}try{l=i.getElementsByTagName("FORM")[0];m=b(l.getElementsByTagName("TEXTAREA"));m=m.concat(b(l.getElementsByTagName("INPUT")));h(j.parameters,m);m.some(function(n){if(n.name==="Web_Map_as_JSON"){n.value="{\"operationalLayers\":[],\"baseMap\":{\"baseMapLayers\":[{\"id\":\"defaultBasemap\",\"opacity\":1,\"visibility\":true,\"url\":\"http://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer\"}],\"title\":\"Topographic\"},\"exportOptions\":{\"dpi\":300,\"outputSize\":[1280,1024]}}"}return n.name==="Web_Map_as_JSON"})}catch(k){console.error(k);alert("invalid form")}}if(!c.test(a)){alert("Navigate to valid print task form.")}else{g(a.replace(c,"")+"?f=json",f)}}());
